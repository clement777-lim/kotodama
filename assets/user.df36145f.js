import{$ as B,d as P,u as C,r as w,a as N,o as h,c as g,b as t,w as a,e,f as F,t as x,E as U,g as u,h as A,i as _,j as D,k as I,n as V,F as M,l as R,m as q}from"./index.32687cf0.js";import{u as G}from"./validate.e51fbab5.js";import{g as H}from"./avatar.fd0791ba.js";async function E(y){return B.put("/user",y)}async function j(){return B.get("/token")}const z=P({__name:"UpdatePassword",setup(y){const{t:s}=C(),r=w(!1),l=w(),n=N({password:"",checkPass:""}),{validatePass:p,validatePass2:o}=G(l,n),c={pass:[{validator:p,trigger:"blur"}],checkPass:[{validator:o,trigger:"blur"}]},m=()=>{l.value.validate(async i=>{if(i)r.value=!0,await E({password:n.password}).then(f=>{f.errno===0&&U.success({message:s("message.update_success"),showClose:!0})}),r.value=!1;else return U.error({message:"\u8BF7\u68C0\u67E5\u5BC6\u7801\u662F\u5426\u4E00\u81F4\uFF01",showClose:!0}),!1})};return(i,f)=>{const v=u("el-input"),b=u("el-form-item"),d=u("el-button"),$=u("el-form");return h(),g("div",null,[t($,{ref_key:"pwdFormRef",ref:l,model:e(n),rules:c},{default:a(()=>[t(b,{prop:"pass",required:""},{default:a(()=>[t(v,{modelValue:e(n).password,"onUpdate:modelValue":f[0]||(f[0]=k=>e(n).password=k),type:"password",autocomplete:"off",placeholder:e(s)("user.password")},null,8,["modelValue","placeholder"])]),_:1}),t(b,{prop:"checkPass",required:""},{default:a(()=>[t(v,{modelValue:e(n).checkPass,"onUpdate:modelValue":f[1]||(f[1]=k=>e(n).checkPass=k),type:"password",autocomplete:"off",placeholder:e(s)("user.confirm_password")},null,8,["modelValue","placeholder"])]),_:1}),t(b,null,{default:a(()=>[t(d,{type:"primary",class:"w-full",loading:e(r),onClick:m},{default:a(()=>[F(x(e(s)("user.update_password")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])}}}),S={m:"4"},T=["src"],J=["href"],K=_("div",{"i-ri-mail-line":""},null,-1),L=_("div",{"i-ri-user-line":""},null,-1),O={key:0,text:"blue-500",class:"mx-1"},Q={key:1,text:"green-600",class:"mx-1"},W={key:2},X=["href"],Y=_("div",{"i-ri-github-line":""},null,-1),Z=["href","target","title"],ee=_("div",{"i-ri-link":""},null,-1),le=P({__name:"UpdateProfile",setup(y){const{t:s}=C(),r=w(!0),l=w({email:"",github:"",type:"administrator",url:"",display_name:""});A(async()=>{const{data:p}=await j();l.value=p,r.value=!1});const n=()=>{E({display_name:l.value.display_name,url:l.value.url,github:l.value.github}).then(p=>{p.errno===0&&U.success({message:s("message.update_success"),showClose:!0})})};return(p,o)=>{const c=u("el-icon"),m=u("el-input"),i=u("el-form-item"),f=u("el-button"),v=u("el-form"),b=R("loading");return h(),g(M,null,[_("div",S,[_("img",{m:"auto",p:"1",class:"rounded-full shadow-lg w-25 h-25",src:e(H)(e(l).email,100)},null,8,T)]),D((h(),I(v,{model:e(l)},{default:a(()=>[t(i,null,{default:a(()=>[t(m,{modelValue:e(l).email,"onUpdate:modelValue":o[0]||(o[0]=d=>e(l).email=d),placeholder:"E-Mail",disabled:"",style:{"--el-disabled-color-base":"#666"}},{prefix:a(()=>[_("a",{class:V(["el-input__icon",e(l).email&&"text-gray"]),href:`mailto:${e(l).email}`,target:"_blank",title:"GitHub"},[t(c,null,{default:a(()=>[K]),_:1})],10,J)]),_:1},8,["modelValue"])]),_:1}),t(i,null,{default:a(()=>[t(m,{modelValue:e(l).display_name,"onUpdate:modelValue":o[1]||(o[1]=d=>e(l).display_name=d),placeholder:e(s)("user.name")},{prefix:a(()=>[t(c,{class:V(["el-input__icon",e(l).display_name&&"text-gray"])},{default:a(()=>[L]),_:1},8,["class"])]),suffix:a(()=>[e(l).type==="administrator"?(h(),g("span",O,"\u7BA1\u7406\u5458")):e(l).type==="guest"?(h(),g("span",Q,"\u5BBE\u5BA2")):(h(),g("span",W,x(e(l).type),1))]),_:1},8,["modelValue","placeholder"])]),_:1}),t(i,null,{default:a(()=>[t(m,{modelValue:e(l).github,"onUpdate:modelValue":o[2]||(o[2]=d=>e(l).github=d),placeholder:e(s)("user.github")},{prefix:a(()=>[_("a",{class:V(["el-input__icon",e(l).github&&"text-gray"]),href:`https://github.com/${e(l).github}`,target:"_blank",title:"GitHub"},[t(c,null,{default:a(()=>[Y]),_:1})],10,X)]),_:1},8,["modelValue","placeholder"])]),_:1}),t(i,null,{default:a(()=>[t(m,{modelValue:e(l).url,"onUpdate:modelValue":o[3]||(o[3]=d=>e(l).url=d),placeholder:e(s)("user.url")},{prefix:a(()=>[_("a",{class:V(["el-input__icon",e(l).url&&"text-gray"]),href:e(l).url||"#",target:e(l).url&&"_blank",title:e(s)("user.url")},[t(c,null,{default:a(()=>[ee]),_:1})],10,Z)]),_:1},8,["modelValue","placeholder"])]),_:1}),t(i,null,{default:a(()=>[t(f,{type:"primary",class:"w-full",onClick:n},{default:a(()=>[F(x(e(s)("user.update_profile")),1)]),_:1})]),_:1})]),_:1},8,["model"])),[[b,e(r)]])],64)}}}),te={class:"el-bg-overlay shadow p-5 max-w-100 m-auto"},ne=P({__name:"user",setup(y){const{t:s}=C(),r=w("profile");return(l,n)=>{const p=le,o=u("el-tab-pane"),c=z,m=u("el-tabs");return h(),g("div",te,[t(m,{modelValue:e(r),"onUpdate:modelValue":n[0]||(n[0]=i=>q(r)?r.value=i:null)},{default:a(()=>[t(o,{label:e(s)("title.profile"),name:"profile"},{default:a(()=>[t(p)]),_:1},8,["label"]),t(o,{label:e(s)("title.password"),name:"password"},{default:a(()=>[t(c)]),_:1},8,["label"])]),_:1},8,["modelValue"])])}}});export{ne as default};
